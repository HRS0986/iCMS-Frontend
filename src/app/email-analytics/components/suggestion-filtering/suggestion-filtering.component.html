<app-page-header
  pageTitle="Email Filtering"
  class="w-full h-fit"
  [breadcrumbItems]="breadcrumbItems"
  [showButton]="false"
/>

<p-panel class="flex flex-col text-left justify-center mb-4">
  <div class="flex gap-8 justify-between">
    <!--Calendar-->
    <div>
      <p>Date Range:</p>
      <div class="card flex justify-content-center">
        <p-calendar
          [(ngModel)]="dateRange"
          selectionMode="range"
          [readonlyInput]="true"
          [showIcon]="true"
          [showButtonBar]="true"
        ></p-calendar>
      </div>
    </div>

    <!--Product-->
    <div>
      <p>Product:</p>
      <div class="card flex justify-content-center grow">
        <p-dropdown
          [options]="products"
          [(ngModel)]="productSelected"
          [showClear]="true"
          placeholder="Product"
        ></p-dropdown>
      </div>
    </div>

    <!--Recepient email account-->
    <div>
      <p>Receiver:</p>
      <div class="card flex justify-content-center">
        <p-dropdown
          [options]="recipientEmails"
          [(ngModel)]="recipientEmailSelected"
          [showClear]="true"
          placeholder="Recepient email accounts"
        ></p-dropdown>
      </div>
    </div>
  </div>

  <br />
  <br />
  <br />

  <!--Next row-->
  <div class="w-100 flex justify-center">
    <!-- Buttons -->
    <div class="card flex center justify-center gap-3 items-end">
      <p-button
        label="Apply Filter"
        (click)="applyFilters()"
        (keydown.enter)="applyFilters()"
      ></p-button>
      <p-button
        label="Clear Filters"
        [outlined]="true"
        (click)="clearFilters()"
        (keydown.enter)="clearFilters()"
      ></p-button>
    </div>
  </div>
  <br />
</p-panel>

<br />

<!-- <div style="margin-bottom: 20px;" *ngFor="let item of suggestionsData">
    <app-suggestion-card 
    [receiver] = "item.receiver"
    [date] = "item.date"
    [productsList] = "item.products"
    [suggestion]="item.suggestion"
    />
    

</div> -->

<p-panel>
  <p-dataView
    [value]="suggestionData"
    layout="list"
    [paginator]="true"
    [rows]="rowsPerPage"
    currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
    [showCurrentPageReport]="true"
    [rowsPerPageOptions]="[10, 15, 20]"
    [totalRecords]="totalRecords"
    [lazy]="true"
    (onLazyLoad)="loadSuggestions($event)"
    (onPageChange)="onPageChange($event)"
    [sortField]="sortField"
    [sortOrder]="sortOrder"
  >
    <ng-template pTemplate="list" let-suggestions>
      <div class="px-5 py-1">
        <div *ngFor="let suggestion of suggestions">
          <ng-container *ngIf="loading">
            <p-skeleton width="100%" height="60px" />
            <p-divider></p-divider>
          </ng-container>
          <ng-container *ngIf="!loading && !errorMessage">
            <!-- <app-suggestion-card
              [receiver]="suggestion.recipient"
              [date]="suggestion.dateSuggested"
              [productsList]="suggestion.tags"
              [suggestion]="suggestion.suggestion"
            /> -->
            <app-suggestion-card-list-type
              [suggestionData]="suggestion"
            />
          </ng-container>
        </div>
        <p-dialog
          header="Error Occured"
          [modal]="true"
          [style]="{ width: '50vw' }"
          [draggable]="false"
          [resizable]="false"
          [(visible)]="dialogVisible"
        >
          <div>{{ errorMessage }}</div>
        </p-dialog>
      </div>
    </ng-template>
  </p-dataView>
</p-panel>
